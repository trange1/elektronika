<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
        "http://www.w3.org/TR/REC-html40/loose.dtd">

<html>

<head>
	<title>PushButton Control</title>
	<meta http-equiv="content-type" content="text/html; charset=windows-1252">
	<meta name="generator" content="RoboHELP by eHelp Corporation - www.ehelp.com">
	<link rel='stylesheet' href='MAIN_TOPIC_ns.css'>
<script type="text/javascript" language="JavaScript" title="WebHelpSplitCss">
<!--
if (navigator.appName !="Netscape")
{   document.write("<link rel='stylesheet' href='MAIN_TOPIC.css'>");}
//-->
</script>
<script type="text/javascript" language="JavaScript" title="WebHelpInlineScript">
<!--
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//-->
</script>
<style type="text/css">
<!--
  div.WebHelpPopupMenu {position:absolute; left:0px; top:0px; z-index:4; visibility:hidden;}
-->
</style>
<script type="text/javascript" language="javascript1.2" src="whmsg.js"></script>
<script type="text/javascript" language="javascript" src="whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="whtopic.js"></script>
</head>

<body>

<script type="text/javascript" language="javascript1.2">
<!--
if (window.gbWhTopic)
{
	if (window.addTocInfo)
	{
	addTocInfo("Mathsoft Controls\nButtons");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(0);

	if (window.setRelStartPage)
	{
	setRelStartPage("DevRef.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();
//-->
</script>
<table>
	<tr>
		<td height="94" valign="top"><h1>Mathsoft PushButton Control</h1></td>
	</tr>
</table>

<h2>
<table>
<tr>
<td valign="top"><img src="Graphics/H2.gif" width="12" height="18" border="0"></td>
<td valign="top">Overview</td></tr>
</table>
</h2>

<p>The Mathsoft PushButton <a href="Controls.html">control</a> allows you to accept user input in the form of button selection and de-selection. By default, push buttons, discussed here, and related <a href="Control_CheckBox.html">check boxes</a> return either a 1 or a 0 (on or off). <a href="Control_RadioButton.html">Radio buttons</a> are used to select between an arbitrarily large collection of choices. More sophisticated behavior is programmed through a script using the <a href="Script_buttonclass.html">Button class</a>, and other features of your scripting language.</p>

<p>You can change the appearance of a button by right-clicking and choosing Properties, or, in some cases, you can access formatting properties through the script.</p>

<h2>
<table>
<tr>
<td valign="top"><img src="Graphics/H2.gif" width="12" height="18" border="0"></td>
<td valign="top">Simple Annotated Example</td></tr>
</table>
</h2>

<p>Here's an example that shows the default script and the resulting behavior of the PushButton control in the worksheet. You can also look at simple and modified examples of the <a href="Control_RadioButton.html">RadioButton control</a> and the <a href="Control_CheckBox.html">CheckBox control</a>.</p>

<h3>Default Script</h3>

<code>Dim state<br>
<br>
Sub PushBtnEvent_Start()<br>
&nbsp;&nbsp;&nbsp;Rem TODO: Add your code here<br>
End Sub<br>
<br>
Sub PushBtnEvent_Exec(Inputs,Outputs)<br>
&nbsp;&nbsp;&nbsp;Outputs(0).value = state<br>
End Sub<br>
<br>
Sub PushBtnEvent_Stop()<br>
&nbsp;&nbsp;&nbsp;Rem TODO: Add your code here<br>
End Sub<br>
<br>
Sub PushBtn_Click()<br>
&nbsp;&nbsp;&nbsp;If state = 0 Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state = 1<br>
&nbsp;&nbsp;&nbsp;Else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state = 0<br>
&nbsp;&nbsp;&nbsp;End If<br>
&nbsp;&nbsp;&nbsp;PushBtn.Recalculate()<br>
End Sub<br>
<br>
</code>

<h3>How It Appears in the Worksheet</h3>

<p class="blockindent"><img src="Graphics/SIMPLE_PUSH_BUTTON.GIF" alt="simple push button" width="116" height="92" border="1"></p>

<h3>Comments</h3>

<p>In the script, notice that there are four events, <a href="Script_StartEvent.html">Start</a>, <a href="Script_ExecEvent.html">Exec</a>, <a href="Script_StopEvent.html">Stop</a>, and <a href="Control_btnevents.html">Click</a>. The Exec event is where inputs and outputs can be processed, namely returning the state of the button. Procedures for formatting the button itself can be taken care of in the Start event or using the Properties dialog box. The Click event is most important where push buttons are concerned because that's where state changes are handled and where the control is re-executed after the user has changed their selection. Notice that in a default push button, there is no visible manifestation of a state change. Here is a slightly modified piece of script and a picture showing its effect on the appearance and behavior of the control:</p>

<h3>Modified Script</h3>

<code>Dim state<br>
<br>
Sub PushBtnEvent_Start()<br>
&nbsp;&nbsp;&nbsp;Rem TODO: Add your code here<br>
End Sub<br>
<br>
Sub PushBtnEvent_Exec(Inputs,Outputs)<br>
&nbsp;&nbsp;&nbsp;Outputs(0).value = state<br>
End Sub<br>
<br>
Sub PushBtnEvent_Stop()<br>
&nbsp;&nbsp;&nbsp;Rem TODO: Add your code here<br>
End Sub<br>
<br>
Sub PushBtn_Click()<br>
&nbsp;&nbsp;&nbsp;If state = 0 Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state = 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PushBtn.Text = &quot;On&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PushBtn.Flat = True<br>
&nbsp;&nbsp;&nbsp;Else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state = 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PushBtn.Text = &quot;Off&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PushBtn.Flat = False<br>
&nbsp;&nbsp;&nbsp;End If<br>
&nbsp;&nbsp;&nbsp;PushBtn.Recalculate()<br>
End Sub<br>
<br>
</code>

<h3>How It Appears in the Worksheet</h3>

<p class="blockindent"><img src="Graphics/MODIFIED_PUSH_BUTTON.GIF" alt="modified push button" width="114" height="93" border="0"></p>
 
<h3>Comments</h3>

<p>In this script, visible elements have been added to the Click event to show the end user the state change. Namely, when the user clicks the button once, the button reads &quot;On&quot; and is displayed as flat. Then, when the user clicks the button again, the button reads &quot;Off&quot; and is displayed as raised.</p>

<h3>Properties Dialog Box</h3>

<p>If you would like to change the appearance of a button without using the script, you can use the Properties Dialog box by right-clicking on the control and selecting <b>Mathsoft Button Control Object > Properties</b> from the menu. You see:</p>

<p class="blockindent"><img src="Graphics/BUTTON_PROPERTIES.GIF" alt="Button Properties" width="404" height="282" border="0"></p>

<p>Note that you can only change a single state setting for the PushButton control using the Properties dialog. In order to program appearance effects for both states of the button, you must use the script. Any settings you have programmed into the script override settings made in the Properties dialog.</p>

<p><object classid="clsid:013500F3-1122-11DB-9380-000D56C6051A"
               id="objLaunchMathcad"
               border="0"
               width="1"
               height="1"
               align="left"></object></p>

<h5><a onMouseOver="document.body.style.cursor='hand'"
	   onMouseOut="document.body.style.cursor='arrow'"
	   onClick="objLaunchMathcad.OpenResourceCenter('samples\\controls\\controls.xmcd')"
	   class="fakelink">Mathcad Example</a></h5>

<hr size="2" width="100%" align="center">

<script type="text/javascript" language="javascript1.2">
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);
//-->
</script>
</body>

</html>
