<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
        "http://www.w3.org/TR/REC-html40/loose.dtd">

<html>

<head>
	<title>Fitting Arbitrary Nonlinear Functions to Data</title>
	<meta http-equiv="content-type" content="text/html; charset=windows-1252">
	<meta name="generator" content="RoboHELP by eHelp Corporation - www.ehelp.com">
	<link rel='stylesheet' href='MAIN_TOPIC_ns.css'>
<script type="text/javascript" language="JavaScript" title="WebHelpSplitCss">
<!--
if (navigator.appName !="Netscape")
{   document.write("<link rel='stylesheet' href='MAIN_TOPIC.css'>");}
//-->
</script>
 <meta name="MS-HAID" content="Polynomial Regression">
<style type="text/css">
<!--
tr.whs1 {height: 94px;}
-->
</style>
<script type="text/javascript" language="JavaScript" title="BSSC Special Effects" src="ehlpdhtm.js"></script><script type="text/javascript" language="JavaScript" title="WebHelpInlineScript">
<!--
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//-->
</script>
<style type="text/css">
<!--
  div.WebHelpPopupMenu {position:absolute; left:0px; top:0px; z-index:4; visibility:hidden;}
-->
</style>
<script type="text/javascript" language="javascript1.2" src="whmsg.js"></script>
<script type="text/javascript" language="javascript" src="whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="whtopic.js"></script>
</head>

<body>

<script type="text/javascript" language="javascript1.2">
<!--
if (window.gbWhTopic)
{
	if (window.addTocInfo)
	{
	addTocInfo("Functions\nCurve Fitting and Smoothing\nGeneralized Regression");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(0);

	if (window.setRelStartPage)
	{
	setRelStartPage("Mcad.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();
//-->
</script>
<table>
	<tr class="whs1">
		<td valign=top><h1>Fitting Nonlinear Functions to Data</h1></td>
	</tr>
</table>

<p><b class="hmath">genfit(vx,vy,vg,F) </b>Returns a vector containing the parameters that make a function <span class="math">f</span> of <span class="math">x</span> and <span class="math">n</span> parameters <span class="math">u<sub>1</sub>...u<sub>n</sub></span> best approximate the data in <b class="math">vx</b> and <b class="math">vy</b>. The <b>genfit</b> function employs an optimized version of the Levenberg-Marquardt method for minimization by default. While frequently faster and less sensitive to poor guess values, this implementation may fail to converge well on problems with many local minima, such as rational functions. It is also more sensitive to incorrect derivative vectors. The optimized method allows you to solve using numerical approximations for the parameter derivatives. To change methods, right-click on the <b>genfit</b> function and select the desired method from the menu.</p>

<h4>Arguments:</h4>

<ul type="disc">
  <li><b class="hmath">vx</b> and <b class="hmath">vy</b> are vectors of real data values of the same length, corresponding to the <span class="math">x</span> and <span class="math">y</span>-values in the data set. There must be at least as many data points as parameters.</li>
  <li><b class="hmath">vg</b> is an <span class="math">n</span>-element vector of guess values for the parameters, or, if <span class="math">n = 1</span>, <b class="math">vg</b> is a scalar. </li>
  <li><b class="hmath">F(x,u)</b> is a fitting function <span class="math">f(x,&lt;parameter list&gt;)</span>, where <span class="math">x</span> is the independent variable, and <span class="math">u </span>is either a vector of parameters or individual parameter names. These equations are both valid representations for a fitting function: 
	
<p class="vmath">f(x,b):=b<sub>0</sub>&middot;x<sup>b<sub>1</sub></sup>&nbsp;&nbsp;and&nbsp;&nbsp;f(x,A,c):=A&middot;x<sup>c</sup></p>

<p>Note that you provide just the name of the fitting function, without any arguments, to <b>genfit</b>.</p></li>
 
  <li><span class="hmath">n</span> is a positive integer. In the case of non-vectorized parameters, there is a limit of 9 individual names.</li>
</ul>

<h2>
<table>
<tr>
<td valign="top"><img src="Graphics/H2.gif" width="12" height="18" border="0"></td>
<td valign="top">Gradient Operator</td></tr>
</table>
</h2>

<p>To improve the convergence and possibly the accuracy of <b>genfit</b>, you can represent <b class="hmath">F</b> as an <span class="math">n + 1</span> vector of functions, in which the first entry is the fitting function <span class="math">f</span>, and the remaining entries are the partial derivatives of <span class="math">f</span> with respect to the <span class="math">n</span> parameters. You can create the vector <b class="hmath">F</b> using the <a href="Gradient_operator.html">gradient operator</a>, which computes the partial derivatives of <span class="math">f</span>, and the vector function <a href="Joining_arrays.html"><b>stack</b></a>. The following shows how to create <b class="hmath">F</b> for the examples above:</p>

<p class="blockindent"><img src="Graphics/genfit.GIF" alt="Fitting functions with partial derivatives" width="366" height="268" border="0"></p>	

<h4>Notes:</h4>

<ul type="disc">
  <li>Provide just the name of the fitting function or vector of functions, without any arguments, to <b>genfit</b>.</li>
  <li>If you are using just the fitting function and allowing <b>genfit</b> to calculate the parameter partial derivatives numerically, you must use the Optimized Levenberg-Marquardt option.</li>
  <li>If <b>genfit</b> has trouble converging, you may wish to try the alternative Levenberg-Marquardt method, other guess values, or scaling your data so that all parameters are of a similar order of magnitude. As with all numerical solution techniques, nonlinear problems are highly sensitive to guess values. You may wish to try plotting your fitting function with the guess values to refine them before using <b>genfit</b>. The Optimized Levenberg-Marquardt method is more sensitive to errors in the supplied algebraic derivatives. If this method is failing, you should check the derivative expressions.</li>
  <li>All older-version worksheets in Mathcad default to the non-optimized Levenberg-Marquardt version to maintain consistency with previous results.</li>
  <li>To further analyze your data, you can apply other <a href="Statistics_functions.html">statistics functions</a> for data analysis. To apply constraints to the parameter solutions, you can use <a href="Approximate_solutions.html">Minerr</a> in a Solve Block.</li>
</ul>

<p><object CLASSID="clsid:013500F3-1122-11DB-9380-000D56C6051A"
			ID=objLaunchMathcad
			BORDER=0
			width=1
			height=1
			align=left>
</object> </p>

<h5><a onMouseOver="document.body.style.cursor='hand'"
		onMouseOut="document.body.style.cursor='arrow'"
		onClick="objLaunchMathcad.OpenResourceCenter('Data_Analysis\\genfitpo.xmcd')"
		class=fakelink>QuickSheet</a></h5>

<p>

<a href="javascript:void(0);" onClick="var e; if (parseInt(navigator.appVersion)>=4){e=event;}  if (parseInt(navigator.appVersion) >=2 && typeof(PopupMenu_Invoke) == 'function') PopupMenu_Invoke(e,'','Exponential Regression','Exponential_regression.html','Linear Regression','Linear_regression.html','Logarithmic Regression','Logarithmic_regression.html','Logistic Regression','Logistic_regression.html','Polynomial Regression','Polynomial_regression.html','Polynomial Regression, Localized','Loess.html','Power Regression','Power_regression.html','Sinusoidal Regression','Sinusoidal_regression.html');return false;" title="Related Topics"><img src="ss_btn_related_topics.gif" border=0 height=16 width=74 alt="Related Topics"></a>

</p>

<hr size="2" width="100%" align="center">

<script type="text/javascript" language="JavaScript" title="WebHelpRelatedTopics"><!--
if (parseInt(navigator.appVersion) >= 3 && typeof (WritePopupMenuLayer) == "function")
  WritePopupMenuLayer();
//--></script><script type="text/javascript" language="javascript1.2">
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);
//-->
</script>
</body>

</html>
